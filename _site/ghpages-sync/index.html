<!--[if lt IE 7]>     <html class="no-js lt-ie9 lt-ie8 lt-ie7" dir="LTR" lang="ru"><![endif]-->
<!--[if IE 7]>        <html class="no-js lt-ie9 lt-ie8"        dir="LTR" lang="ru"><![endif]-->
<!--[if IE 8]>        <html class="no-js lt-ie9"               dir="LTR" lang="ru"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js"                      dir="LTR" lang="ru"><!--<![endif]-->
<head>
	<meta charset="utf-8" />
	<title>Как синхронизировать 'github pages' c 'master' веткой</title>
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width">

	<link href="/css/reset.css"      rel="stylesheet" />
	<link href="/css/layout.css"     rel="stylesheet" />
	<link href="/css/typo.css"       rel="stylesheet" />
	<link href="/css/meslo.css"      rel="stylesheet" />
	<link href="/css/decoration.css" rel="stylesheet" />
	<link href="/css/print.css"      rel="stylesheet" />

	<link href="http://vstarkov.ru/atom.xml" title="Как синхронизировать 'github pages' c 'master' веткой" rel="alternate" type="application/atom+xml" />

	<meta name="google-site-verification" content="4PlN84dxYDr1rBQdoph2v-F2fbnMx4oMCXnf97CltgU" />

	<script src="//ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.0.6-development-only.js"> </script>
</head>
<body>

<div id="skip-links">
	<a href="#main" title="Skip to content area">Skip to content area</a>
</div>

<div class="wrap">
	<!-- HEADER -->
	<header>
		<a href="/" class="logo">
			Владимир Старков
		</a>
	</header>
	<!-- /HEADER -->

	<div class="main_wrap">
		<article>
	<div class="content">
		<h1 id='__github_pages_c_master_'>Как синхронизировать &#8216;github pages&#8217; c &#8216;master&#8217; веткой</h1>

<p>После моего переезда с Tumblr на <a href='http://jekyllrb.com/' title='transform your text into a monster'>Jekyll</a> стала очевидной проблема двух веток и их синхронизация, так как для хостинга сайта нужно иметь сайт в ветке gh-pages, но в тоже время от master никак не избавишься. И хочется всё таки коммитить посты в master, а gh-pages ветка сама обновлялась и отправлялась на сервер.</p>

<p>Существуют несколько очень похожих путей решения проблемы: &#8216;git rebase master&#8217; или &#8216;git merge master&#8217;. Первый способ <a href='http://lea.verou.me/2011/10/easily-keep-gh-pages-in-sync-with-master/' title='Easily keep gh-pages in sync with master'>описан</a> в блоге у Lea Verou. Второй способ по сути заключается в замене &#8216;git rebase master&#8217; на &#8216;git merge master&#8217;.</p>

<pre><code>$ git add .
$ git status // посмотреть какие изменения произошли
$ git commit -m &#39;Some descriptive commit message&#39;
$ git push origin master
$ git checkout gh-pages // сменить ветку на gh-pages
$ git rebase master // синхронизировать gh-pages c master (git merge master)
$ git push origin gh-pages // отправить ветку на сервер.
$ git checkout master // вернуться в master</code></pre>

<p>В этом решении мне не понравилось большое количество строк, выполнении &#8216;git push&#8217; целых два раза для одного коммита. Но самое важное, это я понял механизм работы синхронизации. Ещё одну идею мне подсказал небольшой <a href='http://get.inject.io/n/XxsZ6RE7' title='Git post-commit hook to keep master and gh-pages branch in sync'>пост-коммит хук</a> упомянутый в комментариях к посту Lea Verou.</p>

<p>После этого я написал своё элегантное (мне кажется):</p>

<pre><code>$ git add . &amp;&amp; git commit -m &#39;Some descriptive commit message&#39;
$ git checkout gh-pages &amp;&amp; git merge master &amp;&amp; git checkout master &amp;&amp; git push --all</code></pre>

<p>Первая строчка добавляет в коммитит все модифицированные файлы, и коммитит все файлы — это чаще всего и надо сделать когда добавляешь пост в блог. Вторая строчка объединяет в себе четыре команды (предполагается, что в находитесь в master): смена ветки на gh-pages, объединение с master, возврат в мастер, и отправление обеих веток на сервер.<br />И также я решил использовать &#8216;git merge master&#8217; так как он созраняет историю коммитов.</p>

<p>Спасибо интернету за столь элегантное решение проблемы.</p>
	</div>
	<aside class="comments">
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_shortname = 'starkovru';
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
	</aside>
</article>

	</div>

</div>


<!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
	 mathiasbynens.be/notes/async-analytics-snippet -->
<script>
	var _gaq=[['_setAccount','UA-33089484-1'],['_trackPageview']];
	(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
	g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
	s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>