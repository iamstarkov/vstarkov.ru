---
layout: post
title: Как минифицировать файлы в Jekyll
isNotTranslated: true
categories : [jekyll]
---

Как минифицировать файлы в Jekyll
============================================================

Все хотят быстрые сайты, поэтому необходимо снижать количество запросов на
сервер и минифицировать оставшиеся объёдиненные файлы.

Если у вас блог на Jekyll, то вы не исключение. Чтобы иметь эту возможность,
придётся чуть-чуть поменять структуру вашего сайта.


Для начала создайте файл `_layouts/compress.html`. Этот файл будет шаблоном для
минификации ваших файлов. `strip_newlines` и `replace` —
[стандартные фильтры][1]. В данном случае я настроил свои фильтры на
минификациюю CSS-файлов. Так как блок с комментарием для красоты, то вы можете
его не использовать.

    /**
     * @author  Ваше имя и фамилия
     * @mail    awesomemail@gmail.com
     * @twitter @awesometwitter
     */
    {‍{ content | strip_newlines | replace:' ','' | replace:'    ','' }}

Затем перенесите файлы из папок `js/` и `css/` в папку `_includes`.


После этого создайте файлы `css/styles.min.css` и `js/scripts.min.js` и
перечислите в каждом из них соотвествующие конкатенируемые файлы. Эти файлы
будут выглядить примерно так, как показано ниже. Блок обрамлённый `---` включает
YAML режим для этого файла. А строка `layout: compress` указывает на то, что
должен использоваться шаблон *compress*, созданный нами ранее.

    ---
    layout: compress
    ---

    {‍% include css/normalize.css %}
    {‍% include css/helper.css %}
    {‍% include css/print.css %}
    {‍% include css/main.css %}


После этого в шапке вашего jekyll сайта достаточно будет указать ссылку только
на минифицируемый файл:

    <link href="/css/styles.min.css" rel="stylesheet" />

В моём случае этот [файл][2] выглядит примерно так:  
[![][101]][101]

## Итоги ##

Весь CSS быстро грузится один раз одним маленьким файлом. Сайт стал быстрее,
пользователи счастливее.

[1]: https://github.com/shopify/liquid/wiki/liquid-for-designers#standard-filters
[2]: /css/styles.min.css
[101]: http://img833.imageshack.us/img833/4349/10642240c1e64e2d9405f56.png